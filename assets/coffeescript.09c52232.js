function s(e){return new RegExp("^(("+e.join(")|(")+"))\\b")}var v=/^(?:->|=>|\+[+=]?|-[\-=]?|\*[\*=]?|\/[\/=]?|[=!]=|<[><]?=?|>>?=?|%=?|&=?|\|=?|\^=?|\~|!|\?|(or|and|\|\||&&|\?)=)/,k=/^(?:[()\[\]{},:`=;]|\.\.?\.?)/,m=/^[_A-Za-z$][_A-Za-z$0-9]*/,y=/^@[_A-Za-z$][_A-Za-z$0-9]*/,g=s(["and","or","not","is","isnt","in","instanceof","typeof"]),u=["for","while","loop","if","unless","else","switch","try","catch","finally","class"],z=s(u.concat(["break","by","continue","debugger","delete","do","in","of","new","return","then","this","@","throw","when","until","extends"]));u=s(u);var b=/^('{3}|\"{3}|['\"])/,x=/^(\/{3}|\/)/,w=s(["Infinity","NaN","undefined","null","true","false","on","off","yes","no"]);function i(e,n){if(e.sol()){n.scope.align===null&&(n.scope.align=!1);var t=n.scope.offset;if(e.eatSpace()){var c=e.indentation();return c>t&&n.scope.type=="coffee"?"indent":c<t?"dedent":null}t>0&&d(e,n)}if(e.eatSpace())return null;var o=e.peek();if(e.match("####"))return e.skipToEnd(),"comment";if(e.match("###"))return n.tokenize=A,n.tokenize(e,n);if(o==="#")return e.skipToEnd(),"comment";if(e.match(/^-?[0-9\.]/,!1)){var r=!1;if(e.match(/^-?\d*\.\d+(e[\+\-]?\d+)?/i)&&(r=!0),e.match(/^-?\d+\.\d*/)&&(r=!0),e.match(/^-?\.\d+/)&&(r=!0),r)return e.peek()=="."&&e.backUp(1),"number";var a=!1;if(e.match(/^-?0x[0-9a-f]+/i)&&(a=!0),e.match(/^-?[1-9]\d*(e[\+\-]?\d+)?/)&&(a=!0),e.match(/^-?0(?![\dx])/i)&&(a=!0),a)return"number"}if(e.match(b))return n.tokenize=h(e.current(),!1,"string"),n.tokenize(e,n);if(e.match(x)){if(e.current()!="/"||e.match(/^.*\//,!1))return n.tokenize=h(e.current(),!0,"string.special"),n.tokenize(e,n);e.backUp(1)}return e.match(v)||e.match(g)?"operator":e.match(k)?"punctuation":e.match(w)?"atom":e.match(y)||n.prop&&e.match(m)?"property":e.match(z)?"keyword":e.match(m)?"variable":(e.next(),"error")}function h(e,n,t){return function(c,o){for(;!c.eol();)if(c.eatWhile(/[^'"\/\\]/),c.eat("\\")){if(c.next(),n&&c.eol())return t}else{if(c.match(e))return o.tokenize=i,t;c.eat(/['"\/]/)}return n&&(o.tokenize=i),t}}function A(e,n){for(;!e.eol();){if(e.eatWhile(/[^#]/),e.match("###")){n.tokenize=i;break}e.eatWhile("#")}return"comment"}function l(e,n,t="coffee"){for(var c=0,o=!1,r=null,a=n.scope;a;a=a.prev)if(a.type==="coffee"||a.type=="}"){c=a.offset+e.indentUnit;break}t!=="coffee"?(o=null,r=e.column()+e.current().length):n.scope.align&&(n.scope.align=!1),n.scope={offset:c,type:t,prev:n.scope,align:o,alignOffset:r}}function d(e,n){if(n.scope.prev){if(n.scope.type==="coffee"){for(var t=e.indentation(),c=!1,o=n.scope;o;o=o.prev)if(t===o.offset){c=!0;break}if(!c)return!0;for(;n.scope.prev&&n.scope.offset!==t;)n.scope=n.scope.prev;return!1}return n.scope=n.scope.prev,!1}}const O={startState:function(){return{tokenize:i,scope:{offset:0,type:"coffee",prev:null,align:!1},prop:!1,dedent:0}},token:function(e,n){var t=n.scope.align===null&&n.scope;t&&e.sol()&&(t.align=!1);var c=function(o,r){var a=r.tokenize(o,r),f=o.current();f==="return"&&(r.dedent=!0),((f==="->"||f==="=>")&&o.eol()||a==="indent")&&l(o,r);var p="[({".indexOf(f);if(p!==-1&&l(o,r,"])}".slice(p,p+1)),u.exec(f)&&l(o,r),f=="then"&&d(o,r),a==="dedent"&&d(o,r))return"error";if((p="])}".indexOf(f))!==-1){for(;r.scope.type=="coffee"&&r.scope.prev;)r.scope=r.scope.prev;r.scope.type==f&&(r.scope=r.scope.prev)}return r.dedent&&o.eol()&&(r.scope.type=="coffee"&&r.scope.prev&&(r.scope=r.scope.prev),r.dedent=!1),a=="indent"||a=="dedent"?null:a}(e,n);return c&&c!="comment"&&(t&&(t.align=!0),n.prop=c=="punctuation"&&e.current()=="."),c},indent:function(e,n){if(e.tokenize!=i)return 0;var t=e.scope,c=n&&"])}".indexOf(n.charAt(0))>-1;if(c)for(;t.type=="coffee"&&t.prev;)t=t.prev;var o=c&&t.type===n.charAt(0);return t.align?t.alignOffset-(o?1:0):(o?t.prev:t).offset},languageData:{commentTokens:{line:"#"}}};export{O as coffeeScript};
