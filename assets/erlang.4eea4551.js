var T=["-type","-spec","-export_type","-opaque"],D=["after","begin","catch","case","cond","end","fun","if","let","of","query","receive","try","when"],N=/[\->,;]/,O=["->",";",","],$=["and","andalso","band","bnot","bor","bsl","bsr","bxor","div","not","or","orelse","rem","xor"],j=/[\+\-\*\/<>=\|:!]/,B=["=","+","-","*","/",">",">=","<","=<","=:=","==","=/=","/=","||","<-","!"],C=/[<\(\[\{]/,v=["<<","(","[","{"],F=/[>\)\]\}]/,z=["}","]",")",">>"],G=["is_atom","is_binary","is_bitstring","is_boolean","is_float","is_function","is_integer","is_list","is_number","is_pid","is_port","is_record","is_reference","is_tuple","atom","binary","bitstring","boolean","function","integer","list","number","pid","port","record","reference","tuple"],H=["abs","adler32","adler32_combine","alive","apply","atom_to_binary","atom_to_list","binary_to_atom","binary_to_existing_atom","binary_to_list","binary_to_term","bit_size","bitstring_to_list","byte_size","check_process_code","contact_binary","crc32","crc32_combine","date","decode_packet","delete_module","disconnect_node","element","erase","exit","float","float_to_list","garbage_collect","get","get_keys","group_leader","halt","hd","integer_to_list","internal_bif","iolist_size","iolist_to_binary","is_alive","is_atom","is_binary","is_bitstring","is_boolean","is_float","is_function","is_integer","is_list","is_number","is_pid","is_port","is_process_alive","is_record","is_reference","is_tuple","length","link","list_to_atom","list_to_binary","list_to_bitstring","list_to_existing_atom","list_to_float","list_to_integer","list_to_pid","list_to_tuple","load_module","make_ref","module_loaded","monitor_node","node","node_link","node_unlink","nodes","notalive","now","open_port","pid_to_list","port_close","port_command","port_connect","port_control","pre_loaded","process_flag","process_info","processes","purge_module","put","register","registered","round","self","setelement","size","spawn","spawn_link","spawn_monitor","spawn_opt","split_binary","statistics","term_to_binary","time","throw","tl","trunc","tuple_size","tuple_to_list","unlink","unregister","whereis"],g=/[\w@Ø-ÞÀ-Öß-öø-ÿ]/,I=/[0-7]{1,3}|[bdefnrstv\\"']|\^[a-zA-Z]|x[0-9a-zA-Z]{2}|x{[0-9a-zA-Z]+}/;function U(t,e,n){if(t.current().length==1&&e.test(t.current())){for(t.backUp(1);e.test(t.peek());)if(t.next(),s(t.current(),n))return!0;t.backUp(t.current().length-1)}return!1}function A(t,e,n){if(t.current().length==1&&e.test(t.current())){for(;e.test(t.peek());)t.next();for(;0<t.current().length;){if(s(t.current(),n))return!0;t.backUp(1)}t.next()}return!1}function E(t){return Z(t,'"',"\\")}function W(t){return Z(t,"'","\\")}function Z(t,e,n){for(;!t.eol();){var r=t.next();if(r==e)return!0;r==n&&t.next()}return!1}function s(t,e){return-1<e.indexOf(t)}function i(t,e,n){switch(function(o,_){var u,l,f;_.type!="comment"&&_.type!="whitespace"&&(o.tokenStack=(u=o.tokenStack,l=_,0<(f=u.length-1)&&u[f].type==="record"&&l.type==="dot"?u.pop():(0<f&&u[f].type==="group"&&u.pop(),u.push(l)),u),o.tokenStack=function(a){if(!a.length)return a;var p=a.length-1;if(a[p].type==="dot")return[];if(p>1&&a[p].type==="fun"&&a[p-1].token==="fun")return a.slice(0,p-1);switch(a[p].token){case"}":return m(a,{g:["{"]});case"]":return m(a,{i:["["]});case")":return m(a,{i:["("]});case">>":return m(a,{i:["<<"]});case"end":return m(a,{i:["begin","case","fun","if","receive","try"]});case",":return m(a,{e:["begin","try","when","->",",","(","[","{","<<"]});case"->":return m(a,{r:["when"],m:["try","if","case","receive"]});case";":return m(a,{E:["case","fun","if","receive","try","when"]});case"catch":return m(a,{e:["try"]});case"of":return m(a,{e:["case"]});case"after":return m(a,{e:["receive","try"]});default:return a}}(o.tokenStack))}(t,(r=n,q((c=e).current(),c.column(),c.indentation(),r))),n){case"atom":return"atom";case"attribute":return"attribute";case"boolean":return"atom";case"builtin":return"builtin";case"close_paren":case"colon":return null;case"comment":return"comment";case"dot":return null;case"error":return"error";case"fun":return"meta";case"function":return"tag";case"guard":return"property";case"keyword":return"keyword";case"macro":return"macroName";case"number":return"number";case"open_paren":return null;case"operator":return"operator";case"record":return"bracket";case"separator":return null;case"string":return"string";case"type":return"def";case"variable":return"variable";default:return null}var r,c}function q(t,e,n,r){return{token:t,column:e,indent:n,type:r}}function J(t){return q(t,0,0,t)}function k(t,e){var n=t.tokenStack.length,r=e||1;return!(n<r)&&t.tokenStack[n-r]}function m(t,e){for(var n in e)for(var r=t.length-1,c=e[n],o=r-1;-1<o;o--)if(s(t[o].token,c)){var _=t.slice(0,o);switch(n){case"m":return _.concat(t[o]).concat(t[r]);case"r":return _.concat(t[r]);case"i":return _;case"g":return _.concat(J("group"));case"E":case"e":return _.concat(t[o])}}return n=="E"?[]:t}function x(t,e){var n=t.tokenStack,r=y(n,"token",e);return!!d(n[r])&&n[r]}function y(t,e,n){for(var r=t.length-1;-1<r;r--)if(s(t[r][e],n))return r;return!1}function d(t){return t!==!1&&t!=null}const K={startState:()=>({tokenStack:[],in_string:!1,in_atom:!1}),token:function(t,e){if(e.in_string)return e.in_string=!E(t),i(e,t,"string");if(e.in_atom)return e.in_atom=!W(t),i(e,t,"atom");if(t.eatSpace())return i(e,t,"whitespace");if(!k(e)&&t.match(/-\s*[a-zß-öø-ÿ][\wØ-ÞÀ-Öß-öø-ÿ]*/))return s(t.current(),T)?i(e,t,"type"):i(e,t,"attribute");var n,r=t.next();if(r=="%")return t.skipToEnd(),i(e,t,"comment");if(r==":")return i(e,t,"colon");if(r=="?")return t.eatSpace(),t.eatWhile(g),i(e,t,"macro");if(r=="#")return t.eatSpace(),t.eatWhile(g),i(e,t,"record");if(r=="$")return t.next()!="\\"||t.match(I)?i(e,t,"number"):i(e,t,"error");if(r==".")return i(e,t,"dot");if(r=="'"){if(!(e.in_atom=!W(t))){if(t.match(/\s*\/\s*[0-9]/,!1))return t.match(/\s*\/\s*[0-9]/,!0),i(e,t,"fun");if(t.match(/\s*\(/,!1)||t.match(/\s*:/,!1))return i(e,t,"function")}return i(e,t,"atom")}if(r=='"')return e.in_string=!E(t),i(e,t,"string");if(/[A-Z_Ø-ÞÀ-Ö]/.test(r))return t.eatWhile(g),i(e,t,"variable");if(/[a-z_ß-öø-ÿ]/.test(r)){if(t.eatWhile(g),t.match(/\s*\/\s*[0-9]/,!1))return t.match(/\s*\/\s*[0-9]/,!0),i(e,t,"fun");var c=t.current();return s(c,D)?i(e,t,"keyword"):s(c,$)?i(e,t,"operator"):t.match(/\s*\(/,!1)?!s(c,H)||k(e).token==":"&&k(e,2).token!="erlang"?s(c,G)?i(e,t,"guard"):i(e,t,"function"):i(e,t,"builtin"):((n=t.match(/^\s*([^\s%])/,!1))?n[1]:"")==":"?i(e,t,c=="erlang"?"builtin":"function"):s(c,["true","false"])?i(e,t,"boolean"):i(e,t,"atom")}var o=/[0-9]/;return o.test(r)?(t.eatWhile(o),t.eat("#")?t.eatWhile(/[0-9a-zA-Z]/)||t.backUp(1):t.eat(".")&&(t.eatWhile(o)?t.eat(/[eE]/)&&(t.eat(/[-+]/)?t.eatWhile(o)||t.backUp(2):t.eatWhile(o)||t.backUp(1)):t.backUp(1)),i(e,t,"number")):U(t,C,v)?i(e,t,"open_paren"):U(t,F,z)?i(e,t,"close_paren"):A(t,N,O)?i(e,t,"separator"):A(t,j,B)?i(e,t,"operator"):i(e,t,null)},indent:function(t,e,n){var r,c,o,_,u=d(c=e.match(/,|[a-z]+|\}|\]|\)|>>|\|+|\(/))&&c.index===0?c[0]:"",l=k(t,1),f=k(t,2);return t.in_string||t.in_atom?null:f?l.token=="when"?l.column+n.unit:u==="when"&&f.type==="function"?f.indent+n.unit:u==="("&&l.token==="fun"?l.column+3:u==="catch"&&(r=x(t,["try"]))?r.column:s(u,["end","after","of"])?(r=x(t,["begin","case","fun","if","receive","try"]))?r.column:null:s(u,z)?(r=x(t,v))?r.column:null:s(l.token,[",","|","||"])||s(u,[",","|","||"])?(o=t.tokenStack.slice(0,-1),_=y(o,"type",["open_paren"]),(r=!!d(o[_])&&o[_])?r.column+r.token.length:n.unit):l.token=="->"?s(f.token,["receive","case","if","try"])?f.column+n.unit+n.unit:f.column+n.unit:s(l.token,v)?l.column+l.token.length:(r=function(a){var p=a.tokenStack,b=y(p,"type",["open_paren","separator","keyword"]),S=y(p,"type",["operator"]);return d(b)&&d(S)&&b<S?p[b+1]:!!d(b)&&p[b]}(t),d(r)?r.column+n.unit:0):0},languageData:{commentTokens:{line:"%"}}};export{K as erlang};
